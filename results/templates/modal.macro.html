{% macro blank_modal(modal_id="standings-modal") %}
<div id="{{ modal_id }}" class="modal">
    <div class="modal-background" onclick="close_modal()"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title"></p>
            <button class="delete" aria-label="close" onclick="close_modal()"></button>
        </header>
        <section class="modal-card-body"></section>
    </div>
</div>
{% endmacro %}


{% macro pickset_modal(pickset) %}
    <div class="tabs is-centered">
        <ul>
            <li data-index="0" onclick="pickset_switch_tabs($(this))" class="is-active"><a>Current Tournament</a></li>
            <li data-index="1" onclick="pickset_switch_tabs($(this))"><a>Tournament History</a></li>
        </ul>
    </div>
    {# CURRENT TOURNAMENT SECTION #}
    <section class="tab-section" id="current-tournament-section">
        {% if are_levels_defined(pickset.picks) %}    {# Can't organize if levels havent been defined #}
            <div style="text-align:right;margin: 10px">
                <label style="cursor: pointer">
                    Organize
                    <input type="checkbox" onchange="organize_table($(this).prop('checked'))">
                </label>
            </div>
        {% endif %}
        <table class="table is-fullwidth is-hoverable">
            <thead><tr><th>&nbsp;</th><th>Name</th><th class="has-text-centered">Position</th><th class="has-text-centered">Points</th></tr></thead>
            <tbody>

            {% for player in pickset.picks|sort(attribute="raw_pos", reverse=False) %}
                <tr style="cursor: pointer" class="pick-row" data-pid="{{ player.id }}" data-level="{{ player.level }}">
                    <td><figure class="image is-64x64"><img src="{{ player.photo_url }}"></figure></td>
                    <td class="td-player-name" onclick="prompt_player_modal($(this).parent().data('pid'), $(this).text(), $(this).next().text())">
                        {{ player.name }}
                    </td>
                    <td class="has-text-centered">{% if player.pos is not none %}{{ player.pos }}{% else %}-{% endif %}</td>
                    <td class="td-points has-text-centered">{{ player.points }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </section>
    <section class="tab-section" id="tournament-history-section">
        <table class="table is-fullwidth">
            <tr><th>Tournament</th><th class="has-text-centered">Position</th><th class="has-text-centered">Points</th></tr>
            {% for result in pickset.tournament_history %}
            <tr>
                <td>{{ result.name }}</td>
                <td class="has-text-centered">{{ result.pos }}</td>
                <td class="has-text-centered">{{ result.points }}</td>
            </tr>
            {% endfor %}
            {% if not pickset.tournament_history %}
            <tr><td colspan="3">No history to show</td></tr>
            {% endif %}
        </table>
    </section>
{% endmacro %}


{% macro player_modal(player) %}
    <div class="media">
        <figure class="image media-left is-128x128">   {# Todo: Lazy load #}
            <img src="{{ player.photo_url }}">
        </figure>
        <div class="media-content">
        {% if player.current_tournament_data is not none %}
            <table class="table is-fullwidth is-striped stats-table">
                <tr class="hide"></tr>
                <tr><th>Position</th><th>Score</th></tr>
                <tr>
                    <td>{% if player.current_tournament_data.pos is none %}-{% else %}{{ player.current_tournament_data.pos }}{% endif %}</td>
                    <td>
                         {# Show Total #}
                        {% if player.current_tournament_data.total < 0 %}{{ player.current_tournament_data.total }}
                        {% elif player.current_tournament_data.total > 0 %}+{{ player.current_tournament_data.total }}
                        {% else %}E{% endif %}
                    </td>
                </tr>
                <tr><th>Thru</th><th>Points</th></tr>
                <tr>
                    <td>
                         {# Show Thru #}
                        {% if player.current_tournament_data.thru is none %}-
                        {% elif player.current_tournament_data.thru == 18 %}F
                        {% else %}{{ player.current_tournament_data.thru }}
                        {% endif %}
                    </td>
                    <td>{% if player.current_tournament_data.points is none %}0{% else %}{{ player.current_tournament_data.points }}{% endif %}</td>
                </tr>
            </table>
        {% endif %}
        </div>
    </div>
    {% if player.scorecards and player.scorecards is not none %}
        <hr>
        <section class="scorecards-section">
            <div class="tabs is-centered">
                <ul>
                    {% for scorecard in player.scorecards %}
                        <li data-round="{{ scorecard.round }}" onclick="scorecard_switch_tabs($(this))" class="{% if loop.index == player.scorecards|length %}is-active{% endif %}">
                            <a>Round {{ scorecard.round }}</a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            {% for scorecard in player.scorecards %}
            <div class="table-container" data-round="{{ scorecard.round }}" style="{% if scorecard.round != player.scorecards|length %}display:none{% endif %}">
                <table class="table is-bordered">
                    <tr><th>Hole</th>
                    {% for hole in scorecard.scores %}
                        <td>{{ hole.hole }}</td>
                    {% endfor %}
                    </tr>
                    <tr><th>Par</th>
                    {% for hole in scorecard.scores %}
                        <td>{{ hole.par }}</td>
                    {% endfor %}
                    </tr>
                    <tr><th>Score</th>
                    {% for hole in scorecard.scores %}
                        <td>{{ hole.score }}</td>
                    {% endfor %}
                    </tr>
                </table>
            </div>
            {% endfor %}
        </section>
    {% endif %}
    <hr>
    <section class="who-picked-section">
        {% if player.num_picked == 0 %}
            <h2 class="title is-5">Player was not picked</h2>
        {% else %}

        {% from "helper.macro.html" import collapse_header %}
        <div class="collapse-wrapper">
            {{ collapse_header("Picked by " + player.num_picked|string + " Person(s)", collapsed=player.num_picked > 5, text_size=5) }}
            <div class="collapse-body">
                <table id="picked-by-table" class="table is-fullwidth">
                    {% for ps in player.picked_by %}
                    <tr><td>{{ ps.name }}</td></tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        {% endif %}
        <hr>
    </section>
{% endmacro %}